## Flutter

## flutter环境搭建和Hello  Wrold

### 让Flutter跑起来

虚拟机运行以后，可以点击`debug`按钮，让Flutter程序跑起来。如果你幸运的话，你的Flutter程序经过编译后，就会跑起来了。（这种幸运的机会很小，总会碰到一些小错误，我在这里介绍两个常见的错误）。

### Error runing Gradle 错误解决（1.x版本已经修复）

在Debug项目的时候，应该最常见的错误就是类似下面这样的错误了。

```
Launching lib/main.dart on Android SDK built for x86 in debug mode...
Initializing gradle...
Resolving dependencies...
* Error running Gradle:
ProcessException: Process "/Users/rabbit/develop/android/flutter_app/android/gradlew" exited abnormally:
Project evaluation failed including an error in afterEvaluate {}. Run with --stacktrace for details of the afterEvaluate {} error.

FAILURE: Build failed with an exception.

* Where:
Build file '/Users/rabbit/develop/android/flutter_app/android/app/build.gradle' line: 25

* What went wrong:
A problem occurred evaluating project ':app'.
> Could not resolve all files for configuration 'classpath'.
   > Could not find lint-gradle-api.jar (com.android.tools.lint:lint-gradle-api:26.1.2).
     Searched in the following locations:
         https://jcenter.bintray.com/com/android/tools/lint/lint-gradle-api/26.1.2/lint-gradle-api-26.1.2.jar

* Try:
Run with --stacktrace option to get the stack trace. Run with --info or --debug option to get more log output. Run with --scan to get full insights.

* Get more help at https://help.gradle.org

BUILD FAILED in 0s
  Command: /Users/rabbit/develop/android/flutter_app/android/gradlew app:properties
Finished with error: Please review your Gradle project setup in the android/ folder.
```

这个问题的产生的原因，还是中国特有的问题，解决方案是改位阿里的链接(1.0已经修复了这个问题，不用再重新设置了)。

第一步：修改掉项目下的android目录下的`build.gradle`文件，把google() 和 jcenter()这两行去掉。改为阿里的链接。

```
maven { url 'https://maven.aliyun.com/repository/google' }
maven { url 'https://maven.aliyun.com/repository/jcenter' }
maven { url 'http://maven.aliyun.com/nexus/content/groups/public' }
```

全部代码：

```
buildscript {
    repositories {
        //  google()
        //  jcenter()
        maven { url 'https://maven.aliyun.com/repository/google' }
        maven { url 'https://maven.aliyun.com/repository/jcenter' }
        maven { url 'http://maven.aliyun.com/nexus/content/groups/public'}
        }
        dependencies {
        classpath 'com.android.tools.build:gradle:3.1.2'
    }
}

allprojects {
    repositories {
        // google()
        // jcenter()
        maven { url 'https://maven.aliyun.com/repository/google' }
        maven { url 'https://maven.aliyun.com/repository/jcenter' }
        maven { url 'http://maven.aliyun.com/nexus/content/groups/public' }
    }
}

rootProject.buildDir = '../build'
subprojects {
    project.buildDir = "${rootProject.buildDir}/${project.name}"
}
subprojects {
    project.evaluationDependsOn(':app')
}

task clean(type: Delete) {
    delete rootProject.buildDir
}
```

注意是有两个部分进行了修改，不要只修改一处。

第二步：修改Flutter SDK包下的`flutter.gradle`文件,这个目录要根据你的SDK存放的位置有所变化。比如我放在了D盘Flutter目录下，那路径就是这个。

```
D:\Flutter\flutter\packages\flutter_tools\gradle
```

打开文件进行修改，修改代码如下（其实也是换成阿里的路径就可以了）。

```
buildscript {
    repositories {
        //jcenter()
        // maven {
        //     url 'https://dl.google.com/dl/android/maven2'
        // }
        maven{
            url 'https://maven.aliyun.com/repository/jcenter'
        }
        maven{
            url 'http://maven.aliyun.com/nexus/content/groups/public'
        }
    }
    dependencies {
        classpath 'com.android.tools.build:gradle:3.1.2'
    }
}
```

然后再重新Debug一下，就基本可以启动起来。

还有一种错误是说硬件没有启动GPU，需要下载安装一个程序，这个提示的很清楚，不做过多的介绍了

### VSCode下如何玩转Flutter

### 一条命令快速开启虚拟机

现在想开启虚拟机需要打开`Android Studio`,然后再打开AVD虚拟机，我的电脑足足要等2分钟左右(土豪电脑除外)，我反正是不能接受的，一点不符合极客精神。下面就用一条命令，或者说制作一个批处理文件，来直接开启AVD虚拟机，这样就不用再等两分钟来开启`Android Studio`了。

**开启虚拟机需要两个步骤：**

1. 打开`emulator.exe`这个程序，你可以巧妙利用windows的查找工具进行查找。
2. 打开你设置的虚拟机，批处理时需要填写你设置的虚拟机名称。

**具体步骤如下：**

1. 新建一个`xxx.bat`文件到桌面，xxx的意思是，你可以自己取名字，随意叫什么都可以。我这里叫`EmulatorRun.bat`.
2. 查找`emulator.exe`文件的路径，把查找到的路径放到bat文件中，你一般会查找到两个emulator.exe文件，一个是在tools目录下，一个是在emulator目录下，我们选择`emulator`目录下的这个,复制它的路径。

```
C:\Users\Administrator\AppData\Local\Android\Sdk\emulator\emulator.exe
```

(特别说明，你的和我的很有可能不一样，你要复制i电脑中的路径，不要复制这里的代码)

1. 打开`Android Studio`，并查看你的AVD虚拟机名称 如果你觉的输入不方便和怕出错，你可以点击图片后边的笔型按钮，进入编辑模式，复制这个名称。 
2. 然后根据你复制的名称，把bat文件输入成如下形式。

```
C:\Users\Administrator\AppData\Local\Android\Sdk\emulator\emulator.exe -netdelay none -netspeed full -avd Nexus_5X_API_28
```

进行保存后双击bat文件，就可以迅速打开虚拟机了。

**参数解释：**

- -netdelay none :设置模拟器的网络延迟时间，默认为none，就是没有延迟。
- -netspeed full: 设置网络加速值，full代表全速。

### flutter run 开启预览

现在模拟器也有了，VSCode也支持Flutter开发了.现在可以在VSCode中直接打开终端，快捷键是`ctrl+~`，然后在终端中输入下面的命令。

```
flutter run
```

经过短暂的编译后就会启动我们的程序了（如图）。

到此处，终于搭建出了适合前端程序员的开发环境，下节课开始，我们正式来学习Flutter代码的编写知识。

我们来看几个重点的：

- r 键：点击后热加载，也就算是重新加载吧。
- p 键：显示网格，这个可以很好的掌握布局情况，工作中很有用。
- o 键：切换android和ios的预览模式。
- q 键：退出调试预览模式。

## Flutter常用 组件 

### Text Widget 文本组件的使用

```
import 'package:flutter/material.dart';

void main () => runApp(MyApp());

class  MyApp extends  StatelessWidget{
  @override
  Widget build(BuildContext context){
    return MaterialApp(
      title: 'Text widget',
      home: Scaffold(
        body: Center(
          child: Text(
            'Hello,widget,qewqeqweqweeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee',
            textAlign: TextAlign.center,
            maxLines: 1,  //最大显示条数
            overflow: TextOverflow.ellipsis,  //fade 产生渐变 ellipsis 产生3个点 clip 全部隐藏
            style: TextStyle(
              fontSize: 25.0,
              color: Color.fromARGB(255, 255, 125, 125),
              decoration: TextDecoration.underline,
              decorationStyle: TextDecorationStyle.solid,
            ),
          ),
        ),
      )
    );
  }
}
```

#### textAlign属性 

textAlign属性就是文本的对齐方式，它的属性值有如下几个：

- center: 文本以居中形式对齐,这个也算比较常用的了。
- left:左对齐，经常使用，让文本居左进行对齐，效果和start一样。
- right :右对齐，使用频率也不算高。
- start:以开始位置进行对齐，类似于左对齐。
- end: 以为本结尾处进行对齐，不常用。有点类似右对齐.

#### maxLines属性

设置最多显示的行数，比如我们现在只显示1行，   设置好即文字只显示一行

#### overflow属性

overflow属性是用来设置文本溢出时，如何处理,它有下面几个常用的值供我们选择。

- clip：直接切断，剩下的文字就没有了，感觉不太友好，体验性不好。
- ellipsis:在后边显示省略号，体验性较好，这个在工作中经常使用。
- fade: 溢出的部分会进行一个渐变消失的效果，当然是上线的渐变，不是左右的哦。

### style属性

style属性的内容比较多，具体的你可以查一下API

更详细的属性资料可以参看这个网址：https://docs.flutter.io/flutter/painting/TextStyle-class.html

### Container容器组件的使用

```
import 'package:flutter/material.dart';

void main () => runApp(MyApp());

class MyApp extends  StatelessWidget{
  @override
  Widget build(BuildContext context){
    return MaterialApp(
      title: 'Text widget',
      home: Scaffold(
        body: Center(
          child: Container(
            child: new Text('Hello world', style: TextStyle(fontSize: 40.0)),
            alignment: Alignment.center,
            width: 500.0,
            height: 400.0,
            color: Colors.lightBlue,
          )
        ),
      )
    );
  }
}
```

#### alignment属性

这个属性针对的是Container内child的对齐方式，也就是容器子内容的对齐方式，并不是容器本身的对齐方式。

- bottomCenter:下部居中对齐。
- botomLeft: 下部左对齐。
- bottomRight：下部右对齐。
- center：纵横双向居中对齐。
- centerLeft：纵向居中横向居左对齐。
- centerRight：纵向居中横向居右对齐。
- topLeft：顶部左侧对齐。
- topCenter：顶部居中对齐。
- topRight： 顶部居左对齐。

### 设置宽、高和颜色属性

设置宽、高和颜色属性是相对容易的，只要在属性名称后面加入浮点型数字就可以了，比如要设置宽是500，高是400，颜色为亮蓝色。

## Flutter实战

- Dio库的使用 （发送http请求）
- Swiper插件技巧
- 企业级路由配置Fluro
- 屏幕视频
- 上拉加载效果制作
- 本地存储功能
- 复杂页面布局
- 超50个Widget的使用
- 随时增加的知识技巧